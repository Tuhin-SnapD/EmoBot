# Emotion Detection Chatbot ğŸ¤–

An intelligent chatbot system that detects emotions from user text input using Machine Learning, Deep Learning, and NLP techniques. Built for the AIML Lab Hackathon.

## ğŸ“‹ Overview

This project addresses real-time emotion detection in conversational text, enabling empathetic and context-aware AI interactions. The system classifies 7 emotions (joy, sadness, anger, fear, disgust, surprise, neutral) using a transformer-based model combined with sentiment analysis and probabilistic modeling.

**Key Features:**
- Real-time emotion classification from text
- Context-aware responses based on detected emotions
- Emotion transition tracking using Markov chains
- Interactive web interface with statistics dashboard
- Voice input support (Web Speech API)

## ğŸ—ï¸ Tech Stack

**Backend:**
- Flask (RESTful API)
- Python 3.8+

**Machine Learning:**
- **Transformer Model**: `j-hartmann/emotion-english-distilroberta-base` (DistilRoBERTa)
  - ~82M parameters, ~92% accuracy
  - Hugging Face Transformers + PyTorch
- **Baseline Model**: TF-IDF + Logistic Regression (optional, ~75% accuracy)

**NLP & ML Tools:**
- TextBlob for sentiment analysis
- NLTK for preprocessing (tokenization, lemmatization)
- K-Means clustering with PCA visualization
- Markov chains for emotion transition modeling

**Frontend:**
- HTML5, CSS3, JavaScript (ES6+)
- Bootstrap 5.3
- Chart.js for visualizations

## ğŸš€ Quick Start

### Prerequisites
- Python 3.8+ (tested on 3.9, 3.10, 3.11)
- 4GB RAM minimum (8GB recommended)
- 1GB free disk space

### Installation

**Option 1: Automated Setup (Recommended)**

```bash
# Windows
setup.bat

# Linux/Mac
chmod +x setup.sh
./setup.sh
```

The setup script will:
1. Create virtual environment
2. Install dependencies
3. Download NLTK data
4. Pre-download transformer model (~500MB)
5. Generate `emotion_dataset.csv` from source files

**Option 2: Manual Setup**

```bash
# Create virtual environment
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# Install dependencies
pip install -r requirements.txt

# Download NLTK data and model
python setup_helper.py

# Generate dataset (optional, for training)
python src/convert_to_csv.py
```

### Running the Application

```bash
# Windows
start_app.bat

# Linux/Mac
./start_app.sh

# Or manually
cd backend
python app.py
```

Open your browser: `http://localhost:5000`

## ğŸ’» Usage

### Web Interface
- **Chat**: Type messages and get real-time emotion detection
- **Voice Input**: Click microphone icon to speak (Chrome/Edge)
- **Statistics**: View emotion distribution and transition matrix
- **Visualizations**: See emotion clusters and patterns

### API Endpoints

**POST `/predict`**
```json
{
  "message": "I'm feeling great today!"
}
```

Response:
```json
{
  "predicted_emotion": "joy",
  "bot_reply": "That's wonderful! I'm glad you're feeling positive!",
  "confidence": 0.92,
  "transition_probs": {...},
  "emotion_statistics": {...}
}
```

**GET `/stats`** - Get emotion statistics and transition matrix

**GET `/clusters`** - Get emotion cluster visualization

**POST `/reset`** - Reset conversation history

**GET `/health`** - Health check endpoint

## ğŸ“ Project Structure

```
emotion_detection_chatbot/
â”œâ”€â”€ backend/              # Flask application
â”‚   â”œâ”€â”€ app.py           # API endpoints
â”‚   â”œâ”€â”€ emotion_model.py # ML model logic
â”‚   â”œâ”€â”€ static/          # Frontend assets
â”‚   â””â”€â”€ templates/       # HTML templates
â”œâ”€â”€ src/                 # Training scripts
â”‚   â”œâ”€â”€ train_baseline.py
â”‚   â”œâ”€â”€ convert_to_csv.py
â”‚   â””â”€â”€ preprocessing.py
â”œâ”€â”€ data/                # Datasets
â”‚   â”œâ”€â”€ emotion_responses.json  # Bot responses
â”‚   â”œâ”€â”€ train.txt, test.txt, val.txt  # Source data
â”‚   â””â”€â”€ emotion_dataset.csv     # Generated (gitignored)
â”œâ”€â”€ models/              # Saved models (gitignored)
â”œâ”€â”€ notebooks/           # Jupyter notebooks
â”œâ”€â”€ tests/               # Test suite
â””â”€â”€ requirements.txt     # Dependencies
```

## ğŸ§  ML/AI Concepts Applied

1. **Deep Learning**: Transformer architecture (DistilRoBERTa) for emotion classification
2. **NLP**: Text preprocessing, sentiment analysis, tokenization
3. **Unsupervised Learning**: K-Means clustering with PCA for emotion visualization
4. **Probabilistic Modeling**: Markov chains for emotion transition tracking
5. **Ensemble Methods**: Hybrid approach combining transformer, sentiment, and rule-based refinement

## ğŸ“Š Model Performance

**Production Model (DistilRoBERTa):**
- Accuracy: ~92%
- Macro F1-Score: ~0.90
- Latency: ~250ms (CPU), ~50ms (GPU)

**Baseline Model (TF-IDF + LR):**
- Accuracy: ~75%
- Useful for comparison and training demonstrations

## ğŸ”¬ Training (Optional)

To train the baseline model:

```bash
# Ensure emotion_dataset.csv exists (auto-generated by setup)
python src/train_baseline.py
```

This generates:
- `models/emotion_model.pkl`
- `models/vectorizer.pkl`
- Visualization plots

Note: The backend uses the transformer model, not the baseline .pkl files.

## ğŸ§ª Testing

```bash
pytest tests/
```

Test coverage includes:
- Unit tests for emotion detection
- API integration tests
- Preprocessing tests

## ğŸ“ API Documentation

All endpoints return JSON with appropriate HTTP status codes:
- `200 OK`: Success
- `400 Bad Request`: Invalid input
- `500 Internal Server Error`: Server error

Example Python client:
```python
import requests

response = requests.post("http://localhost:5000/predict", 
    json={"message": "I'm terrified of the dark"})
data = response.json()
print(f"Emotion: {data['predicted_emotion']}")
print(f"Confidence: {data['confidence']:.2f}")
```

## ğŸ¤ Contributing

1. Fork the repository
2. Create a feature branch: `git checkout -b feature-name`
3. Make changes and test: `pytest tests/`
4. Commit with clear messages
5. Push and submit a pull request

## ğŸ“„ License

This project is created for educational purposes as part of the AIML Lab Hackathon.

## ğŸ™ Acknowledgments

- **Hugging Face** for transformer models and ecosystem
- **Johannes Hartmann** for `emotion-english-distilroberta-base` model
- **NLTK** and **TextBlob** communities for NLP tools

---

For detailed technical documentation and ML concept explanations, see the code comments and inline documentation.
